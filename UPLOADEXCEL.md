# Excel导入模板说明

## 基本格式要求

1. **文件格式**：支持 `.xlsx` 和 `.xls` 格式
2. **文件大小**：不超过 1MB
3. **数据位置**：数据应该从第一行开始，第一行为表头
4. **图片功能**：仅支持 `.xlsx` 格式的图片提取

## 图片功能说明

### 支持的图片格式

- PNG
- JPEG/JPG
- GIF
- BMP

### 如何添加图片到Excel

1. **文件格式要求**：
   - 图片功能仅支持 `.xlsx` 格式
   - `.xls` 格式不支持图片提取

2. **插入图片**：
   - 在Excel中，点击"插入" → "图片"
   - 选择要插入的图片文件
   - 将图片放置在合适的位置

3. **图片位置**：
   - 图片会自动与最近的单元格关联
   - 建议将图片放在数据行的对应列中
   - 图片大小建议不超过100x100像素

4. **特殊格式**：
   - 系统支持 `=DISPIMG("图片名称", 参数)` 格式的图片
   - 这种格式的图片会被自动识别和提取
   - 例如：`=DISPIMG("avatar1", 1)`

### 图片提取规则

- 系统会自动提取Excel中的图片
- 支持 `=DISPIMG("图片名称", 参数)` 格式的图片
- 图片会转换为Blob格式并显示在预览中
- 图片数据会与对应的行数据一起保存
- 图片会以对象形式存储：`{ file, blob, dataUrl }`

### 注意事项

1. **图片大小**：过大的图片会影响导入速度
2. **图片数量**：建议每行不超过2-3张图片
3. **图片质量**：建议使用适当压缩的图片以减小文件大小
4. **兼容性**：某些特殊格式的图片可能无法正确提取

## 数据格式示例

| 姓名 | 公司 | 祝福语 | 头像 |
|------|------|--------|------|
| 张三 | 牛马科技 | 新年快乐！ | =DISPIMG("avatar1", 1) |
| 李四 | 牛马科技 | 恭喜发财！ | =DISPIMG("avatar2", 1) |

## 常见问题

**Q: 为什么我的图片没有显示？**
A: 请检查图片格式是否支持，以及图片是否正确插入到Excel中。

**Q: 图片显示不完整怎么办？**
A: 请调整图片大小，建议不超过100x100像素。

**Q: 导入速度很慢怎么办？**
A: 请压缩图片大小，或减少图片数量。

**Q: 为什么我的.xls文件中的图片没有显示？**
A: 图片功能仅支持.xlsx格式，.xls格式不支持图片提取。

**Q: 出现"Corrupted zip"错误怎么办？**
A: 这通常是因为文件不是.xlsx格式，请确保使用.xlsx格式的文件。

## 技术支持

如果遇到问题，请检查：

1. Excel文件格式是否正确
2. 图片格式是否支持
3. 文件大小是否超限
4. 网络连接是否正常
